<!DOCTYPE html><html lang="pt-br"><head><meta charSet="UTF-8"/><title data-react-helmet="true">Fazendo um bom Code Review | Gabriel Prates</title><meta data-react-helmet="true" property="og:title" content="Fazendo um bom Code Review"/><meta data-react-helmet="true" name="author" content="Gabriel Prates"/><meta data-react-helmet="true" property="og:locale" content="pt_BR"/><meta data-react-helmet="true" name="description" content="Como fazer um bom code review? Me fa√ßo essa pergunta periodicamente, para sempre fazer melhor. Recentemente vi uma talk, do Derek Prior, sobre o assunto e acredito que ele levantou uma √≥tima refer√™ncia de como seria um bom code review e sua cultura. Neste post, vamos explorar um pouco os pontos levantados na talk."/><meta data-react-helmet="true" property="og:description" content="Como fazer um bom code review? Me fa√ßo essa pergunta periodicamente, para sempre fazer melhor. Recentemente vi uma talk, do Derek Prior, sobre o assunto e acredito que ele levantou uma √≥tima refer√™ncia de como seria um bom code review e sua cultura. Neste post, vamos explorar um pouco os pontos levantados na talk."/><meta data-react-helmet="true" property="og:url" content="https://gabrielprates.com/2020/04/16/fazendo-um-bom-code-review.html"/><meta data-react-helmet="true" property="og:site_name" content="Gabriel Prates"/><meta data-react-helmet="true" property="og:image" content="https://gabrielprates.com/assets/perfil-small.jpg"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="article:published_time" content="2020-04-16T00:00:00.000Z"/><link data-react-helmet="true" rel="canonical" href="https://gabrielprates.com/2020/04/16/fazendo-um-bom-code-review.html"/><script data-react-helmet="true" type="application/ld+json">{"@type":"BlogPosting","url":"https://gabrielprates.com/2020/04/16/fazendo-um-bom-code-review.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://gabrielprates.com/assets/perfil-small.jpg"},"name":"Gabriel Prates"},"author":{"@type":"Person","name":"Gabriel Prates"},"headline":"Fazendo um bom Code Review","description":"Como fazer um bom code review? Me fa√ßo essa pergunta periodicamente, para sempre fazer melhor. Recentemente vi uma talk, do Derek Prior, sobre o assunto e acredito que ele levantou uma √≥tima refer√™ncia de como seria um bom code review e sua cultura. Neste post, vamos explorar um pouco os pontos levantados na talk.","@context":"https://schema.org","dateModified":"2020-04-16T00:00:00.000Z","datePublished":"2020-04-16T00:00:00.000Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://gabrielprates.com/2020/04/16/fazendo-um-bom-code-review.html"}}</script><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="theme-color" content="#406b63"/><link rel="stylesheet" href="/style.css"/><link type="image/x-icon" rel="shortcut icon" href="/favicon.ico"/><link rel="alternate" type="application/rss+xml" title="Gabriel Prates" href="https://gabrielprates.com/feed.xml"/><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700" rel="stylesheet"/></head><body><header class="site-header"><div class="wrapper"><a class="site-title" href="/" title="Gabriel Prates"><img alt="Gabriel Prates" src="/assets/perfil-small.jpg" class="site-title__image"/>Gabriel Prates</a><nav class="site-nav"><button class="menu-icon"><span></span><span></span><span></span></button><div class="trigger"><a href="/about/" title="Sobre mim" class="page-link">Sobre mim</a><a href="/projects/" title="Projetos" class="page-link">Projetos</a><a href="https://slides.com/gabsprates" title="Talks" target="_blank" class="page-link">Talks</a></div></nav></div></header><div class="page-content"><main class="wrapper"><article class="post" itemscope="" itemType="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title" itemProp="name headline">Fazendo um bom Code Review</h1><p class="post-meta"><time dateTime="2020-04-16T00:00:00.000Z" itemProp="datePublished">Apr 16, 2020</time></p></header><div class="post-content"><p><strong>Como fazer um bom code review?</strong> Me fa√ßo essa pergunta periodicamente, para sempre fazer melhor. Recentemente vi uma <a href="https://www.youtube.com/watch?v=PJjmw9TRB7s">talk</a>, do <a href="https://www.linkedin.com/in/derek-prior-1145a2/">Derek Prior</a>, sobre o assunto e acredito que ele levantou uma √≥tima refer√™ncia de como seria um bom code review e sua cultura. Neste post, vamos explorar um pouco os pontos levantados na talk.</p>
<p>Antes de come√ßarmos, fa√ßa uma reflex√£o respondendo essas 3 perguntas:</p>
<ul>
<li>Voc√™ faz code review como parte do teu trabalho?</li>
<li>Voc√™ gosta de fazer code review?</li>
<li>Se voc√™ faz, faz porque <strong>TEM</strong> que fazer (como obriga√ß√£o)?</li>
</ul>
<p>Pronto? Vamos l√°.</p>
<h2 id="por-que-n√≥s-fazemos-reviews">Por que n√≥s fazemos reviews?</h2>
<p><strong><em>Para achar bugs</em></strong>, voc√™ pode ter pensado. Isso realmente acaba fazendo parte do processo, analisando o <em>diff</em> do Git.</p>
<p>Segundo o estudo <em><a href="https://www.microsoft.com/en-us/research/publication/expectations-outcomes-and-challenges-of-modern-code-review/">Expectations, Outcomes, and Challenges of Modern Code Review</a></em>, realizado pela Microsoft em parceria com a Universidade de Lugano (Su√≠√ßa), a grande maioria dos desenvolvedores entrevistados tamb√©m acreditavam que <strong>encontrar defeitos</strong> era o maior motivo de se fazer code review. Dentre os motivos citados, temos:</p>
<ol>
<li><strong>Encontrando defeitos</strong></li>
<li><strong>Melhoria de c√≥digo</strong></li>
<li><strong>Solu√ß√µes alternativas</strong></li>
<li><strong>Transfer√™ncia de conhecimento</strong></li>
<li><strong>Conscientiza√ß√£o da equipe</strong></li>
</ol>
<p>Acredito, em concord√¢ncia com a talk do Derek Prior, que podemos tirar um proveito muito grande desses outros motivos e usar o code review como uma ferramenta para nos ajudar a <strong>fazer um trabalho cada dia melhor</strong>.</p>
<p>Um das entrevistadas nesse estudo disse que code review √© a</p>
<blockquote>
<p>discipline of explaining your code to your peers [that] drives a higher standard of coding. I think <strong>the process is even more important than the result.</strong></p>
</blockquote>
<p>Gosto dessa defini√ß√£o, mas se mudarmos a palavra <strong>explicar</strong> para <strong>discutir</strong>, percebemos que √© uma quest√£o de comunica√ß√£o, saber comunicar melhor e ter uma comunica√ß√£o melhor com o time. Um bom code review √© consequ√™ncia disso.</p>
<h2 id="criando-uma-forte-cultura-de-code-review">Criando uma forte cultura de code review</h2>
<p>Uma das coisas que precisamos pensar √© <strong>como devemos agir durante o code review?</strong></p>
<p>Nesse caso, precisamos identificar qual o nosso papel:</p>
<ul>
<li><strong>como autor</strong>; e</li>
<li><strong>como reviewer</strong></li>
</ul>
<h3 id="como-autor-d√™-contexto-suficiente">Como autor, d√™ contexto suficiente</h3>
<p>Quem faz review precisa saber <strong>o que foi alterado e por qu√™?</strong></p>
<p>√â muito importante que, ao criar um <em>pull/merge request</em>, voc√™ d√™ o m√°ximo de contexto poss√≠vel sobre o que est√° fazendo.</p>
<p>Se a pessoa que far√° review for autora do c√≥digo que voc√™ alterou, ser√° mais f√°cil pra ela entender as tuas altera√ß√µes. Caso ela nunca tenha visto aquele c√≥digo, o que acontece muito, seja porque √© uma pessoa nova no time, ou porque √© algu√©m que n√£o conhece mesmo aquele c√≥digo, essa pessoa precisa saber o qual o objetivo daquele c√≥digo e porqu√™ aquela altera√ß√£o foi feita.</p>
<p>Segundo a pesquisa citada:</p>
<blockquote>
<p>when the <strong>context is clear and understanding is very high</strong>, as in the case when the reviewer is the owner of changed files, <strong>code review authors receive comments that explore &quot;deeper details,&quot; are &quot;more directed&quot; and &quot;more actionable and pertinent,&quot; and find &quot;more subtle issues.&quot;</strong></p>
</blockquote>
<p>√â <strong>importante que voc√™ d√™ contexto</strong> para quem for fazer review. <strong>Contexto</strong> √© a palavra chave!</p>
<ul>
<li>Se √© uma altera√ß√£o que prop√µe uma nova forma de fazer algo, explique e d√™ exemplos;</li>
<li>Se √© uma altera√ß√£o que corrige um bug, d√™ contexto, diga como reproduzir, explique qual era o erro e como corrigiu;</li>
<li>Se √© uma nova feature, explique o requisito e passos para reprodu√ß√£o.</li>
</ul>
<p>Coloque issues de refer√™ncia tamb√©m, se poss√≠vel.</p>
<p>Segundo <a href="https://www.garyvaynerchuk.com/content-is-king-but-context-is-god/">Gary Vaynerchuk</a>:</p>
<blockquote>
<p>Content is king, but <strong>context</strong> is God</p>
</blockquote>
<p>Dica: <a href="https://help.github.com/en/github/building-a-strong-community/creating-a-pull-request-template-for-your-repository">templates de pull requests</a> podem ajudar nesse ponto.</p>
<h3 id="como-reviewer-fa√ßa-perguntas-no-lugar-de-dar-ordens">Como reviewer, fa√ßa perguntas no lugar de dar ordens</h3>
<p>J√° ouviu falar no <a href="https://pt.wikipedia.org/wiki/M%C3%A9todo_socr%C3%A1tico">M√©todo Socr√°tico</a>? <del>Lembrei de algumas pessoas falando que n√£o entendem o motivo de ter filosofia em cursos de computa√ß√£o.</del> Podemos aprender algo com ele:</p>
<blockquote>
<p>...√© uma t√©cnica de investiga√ß√£o filos√≥fica feita em <strong>di√°logo</strong>, que consiste em o professor <strong>conduzir</strong> o aluno <strong>a um processo de reflex√£o e descoberta</strong> [...] Para isso o professor <strong>faz uso de perguntas simples e quase ing√™nuas</strong> que t√™m por <strong>objetivo</strong>, em primeiro lugar, <strong>revelar</strong> as contradi√ß√µes presentes na <strong>atual forma de pensar</strong> do aluno...</p>
</blockquote>
<p>Considere o seguinte coment√°rio (que eu provavelmente j√° fiz em algum review):</p>
<blockquote>
<p>Essa l√≥gica t√° repetida em v√°rios lugares. Transforma numa fun√ß√£o e chama a fun√ß√£o quando precisar.</p>
</blockquote>
<p>Consigo perceber alguns problemas com esse coment√°rio:</p>
<ul>
<li>n√£o incentivo a pesquisa da outra pessoa;</li>
<li>de certa forma, tiro o cr√©dito dela sobre o c√≥digo que est√° escrevendo;</li>
<li>n√£o h√° discuss√£o.</li>
</ul>
<p>Talvez seja um pouco daquela hist√≥ria de <em>&quot;dar o peixe ou ensinar a pescar&quot;</em>. O que queremos √© ter uma √≥tima discuss√£o t√©cnica, para o crescimento de todo mundo no time. Ser imperativo dessa forma n√£o parece ajudar muito. Quando criamos, ou incentivamos a discuss√£o, temos a oportunidade de que todo mundo tire proveito disso. Podemos aprender uns com os outros! J√° parou pra pensar em quantas oportunidades podem ser perdidas por esse motivo?</p>
<p>Que tal transformar esse coment√°rio em algo mais <strong>positivo</strong> e <strong>instigador</strong>?</p>
<blockquote>
<p>O que voc√™ acha de extrair essa l√≥gica em uma fun√ß√£o para evitar repeti√ß√£o?</p>
</blockquote>
<p>Parece bobo, mas sim, faz uma grande diferen√ßa. A forma como se fala faz muita diferen√ßa. Lembre-se: <strong>√© uma quest√£o de comunica√ß√£o</strong>. Pode doer um pouco no in√≠cio, mas garanto que far√° um grande bem ao time e a voc√™.</p>
<p>Dica: algumas formas de come√ßar uma discuss√£o:</p>
<ul>
<li><strong>O que voc√™ acha de</strong>... ?</li>
<li><strong>Voc√™ j√° considerou</strong>... ?</li>
<li><strong>Voc√™ pode explicar melhor</strong>... ?</li>
</ul>
<p>Seja <strong>positivo!!!</strong></p>
<p>Ok, conseguimos gerar uma discuss√£o. E como resolvemos conflitos?</p>
<h2 id="resolvendo-conflitos">Resolvendo conflitos</h2>
<p>Bom, isso pode ser um pouco complicado. Pense o seguinte:</p>
<blockquote>
<p>√â uma quest√£o de <strong>n√£o estar bom</strong>, <strong>OU</strong> √© uma quest√£o de que <strong>eu faria diferente</strong>?</p>
</blockquote>
<p>Se √© uma quest√£o de <strong>n√£o estar bom</strong>, explique os motivos, d√™ refer√™ncias, tente n√£o deixar d√∫vidas dos motivos que voc√™ discorda daquela solu√ß√£o, ou o porqu√™ dela n√£o ser boa. Existe algum <a href="https://pt.wikipedia.org/wiki/Trade-off"><em>trade-off</em></a> envolvido? Seja claro, positivo e instigue a pesquisa.</p>
<p>Se √© uma quest√£o de <strong>eu faria diferente</strong>, est√° tudo bem! N√£o √© um problema, voc√™ s√≥ tem uma solu√ß√£o diferente e t√£o boa quanto! Lembre-se, √© uma oportunidade de aprender (:</p>
<h2 id="o-que-revisar">O que revisar?</h2>
<p>Na hora de revisar c√≥digo, mantenha o foco em coisas como:</p>
<ul>
<li><strong>nomenclatura</strong>: fun√ß√µes, vari√°veis, classes, m√©todos, etc., isso faz parte de um c√≥digo limpo e saud√°vel;</li>
<li><strong>complexidade</strong>: est√° dif√≠cil de entender o c√≥digo em quest√£o, ou tem uma forma melhor de fazer?</li>
<li><strong>responsabilidade e requisito</strong>: esse trecho de c√≥digo faz o que deveria?</li>
</ul>
<p>Por favor, se voc√™ est√° comentando coisas como <strong>&quot;use aspas simples no lugar de aspas duplas&quot;</strong>, ou <strong>&quot;use espa√ßo no lugar de tab&quot;</strong>, ou <strong>&quot;tem que ter quebra de linha antes do <code>{</code>&quot;</strong>, por favor:</p>
<p><strong>PARE COM ISSO AGORA!</strong></p>
<p>Isso deve ser um trabalho para linters e formatadores de c√≥digo. Essas ferramentas existem e salvam muito tempo √∫til. O padr√£o de estilo de c√≥digo definido pelo teu time deve ser documentado e automatizado. Isso √© algo que uma m√°quina pode fazer, deixe ela fazer e foque em coisas que s√≥ voc√™ pode fazer!</p>
<p>Dica: <a href="/2016/08/07/que-nao-vai-padronizar-o-que.html">tem um outro post meu</a> com dicas de guias de estilo de c√≥digo para C, CSS, JavaScript, PHP, Python e Ruby. D√™ uma olhada e pesquise alguma ferramenta de automa√ß√£o e guia de estilo para as linguagens que voc√™ utiliza. Aceito sugest√µes nos coment√°rios üòâ</p>
<hr/>
<h2 id="o-que-ganhamos-com-code-review">O que ganhamos com code review?</h2>
<p>Sem d√∫vidas, com um bom processo de code review, n√≥s teremos:</p>
<ul>
<li>Um c√≥digo melhor;</li>
<li>Desenvolvedores melhores;</li>
<li>Debates saud√°veis;</li>
<li>Um compartilhamento da propriedade do c√≥digo.</li>
</ul>
<p>Um dos motivos listados na pesquisa, sobre porqu√™ fazer code review, √© o <strong>compartilhamento da propriedade do c√≥digo</strong>.</p>
<p>Acredito que isso significa que, vendo o c√≥digo de outras pessoas e mostrando a elas o nosso, dando e recebendo feedbacks, n√≥s compartilhamos o sentimento de que √© um c√≥digo do <strong>time</strong>, do <strong>produto</strong>.</p>
<p>Esse √© um ponto que eu e meu time, front-ends do <a href="https://palcomp3.com.br">Palco MP3</a> tentamos lembrar sempre que necess√°rio. Durante o code review, n√≥s fazemos o que podemos para entregar um resultado √≥timo, tanto de c√≥digo quanto de funcionalidade e usabilidade e ter em mente que √© um resultado nosso. Mesmo que determinada feature foi escrita por uma pessoa em particular, o c√≥digo acaba sendo do time, do produto; damos feedbacks, discutimos solu√ß√µes e trazemos melhorias fazendo do code review uma ferramenta de desenvolvimento pessoal e da equipe.</p>
<p>Assim temos um c√≥digo melhor, desenvolvedores mais maduros e, consequentemente, times e produtos melhores.</p>
</div></article><hr/><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://gabrielprates.com/2020/04/16/fazendo-um-bom-code-review.html";
  this.page.identifier = "/2020/04/16/fazendo-um-bom-code-review";
};
(function() {  // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//gabsprates.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the<!-- --> <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></main></div><footer class="site-footer"><div class="wrapper"><h2 class="footer-heading">Gabriel Prates</h2><div class="footer-col-wrapper"><div class="footer-col footer-col-1"><ul class="contact-list"><li><a href="https://github.com/gabsprates" title="Gabriel Prates no GitHub" target="_blank">github@<!-- -->gabsprates</a></li><li><a href="https://twitter.com/gabsprates" title="Gabriel Prates no Twitter" target="_blank">twitter@<!-- -->gabsprates</a></li><li><a href="https://br.linkedin.com/in/gabrielprates" title="Gabriel Prates no LinkedIn" target="_blank">linkedin@<!-- -->gabrielprates</a></li><li><a href="https://gabrielprates.com" title="Meu site" target="_blank">gabrielprates.com</a></li></ul></div><div class="footer-col footer-col-3"><p>Desenvolvedor h√° mais de 13 anos e baterista nas horas vagas
#js #frontend #opensource #busquemconhecimento</p></div></div></div></footer><script id="dsq-count-scr" src="//gabsprates.disqus.com/count.js" async=""></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-92988633-1', 'auto');
ga('send', 'pageview');</script></body></html>